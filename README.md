è¿™æ˜¯ä¸€ä¸ªç”¨äºåª’ä½“ç®¡ç†çš„å®ç”¨å·¥å…·é›†ï¼ŒåŒ…å«ä¸¤ä¸ª Python è„šæœ¬ï¼š

1. `tmdb_export.py`ï¼šç”¨äºå¯¼å‡º TMDB å…ƒæ•°æ®ï¼ˆæ”¯æŒå‰§é›†æ•´åˆä¸å¤šé›†å¯¼å‡ºï¼‰ï¼›
2. `compare_media.py`ï¼šç”¨äºæ¯”å¯¹ç›®å½•ä¸­è§†é¢‘æ–‡ä»¶çš„å·®å¼‚ã€‚

---
# ğŸ“ è„šæœ¬ä¸€ï¼štmdb_export.py

## ğŸ§© åŠŸèƒ½ä»‹ç»

### 1ï¸âƒ£ tmdb_export.pyï¼šTMDB å…ƒæ•°æ®å¯¼å‡ºå·¥å…·

æ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š

- åŸºäº TMDB API è·å–å‰§é›†ã€ç”µå½±çš„å…ƒæ•°æ®ï¼›
- æ”¯æŒå¤šå­£åˆå¹¶ä¸ºä¸€ä¸ªå­£ï¼ˆå¦‚ç¬¬ 1~3 å­£åˆå¹¶ä¸ºâ€œç¬¬ 1 å­£â€ï¼‰ï¼›
- æ¯é›†å•ç‹¬å¯¼å‡ºä¸º JSON æ–‡ä»¶ï¼›
- æ–‡ä»¶å‘½åè§„åˆ™æ˜ç¡®ï¼Œä¾¿äºåª’ä½“åº“å¯¼å…¥ï¼›
- è¾“å‡ºå­—æ®µåŒ…å«ä¸­æ–‡æ³¨é‡Šï¼ˆzh-CNï¼‰ï¼›
- å¯é€‰æ‹©è¾“å‡ºå“ªäº›å­£ã€å“ªäº›é›†ã€‚

#### âœ… ä½¿ç”¨ç¤ºä¾‹

```bash
python tmdb_export.py <tmdbid> <apikey> <output> [é€‰é¡¹]
```

### å¿…éœ€å‚æ•°

| å‚æ•°     | è¯´æ˜               | ç¤ºä¾‹           |
|----------|--------------------|----------------|
| tmdbid   | TMDB IDï¼ˆæ•°å­—ï¼‰    | `4013`         |
| apikey   | TMDB APIå¯†é’¥       | `your_api_key` |
| output   | è¾“å‡ºç›®å½•è·¯å¾„       | `./output`     |

### å¯é€‰å‚æ•°

| é€‰é¡¹              | è¯´æ˜                                  | é»˜è®¤å€¼ | ç¤ºä¾‹                                 |
|-------------------|---------------------------------------|--------|--------------------------------------|
| `--type`          | å†…å®¹ç±»å‹ï¼š`auto` / `movie` / `tv` / `collection` | auto   | `--type tv`                          |
| `--apiversion`    | APIç‰ˆæœ¬ï¼š`v3` / `v4`                   | v3     | `--apiversion v4`                    |
| `--combine-seasons` | å°†æ‰€æœ‰å­£åˆå¹¶ä¸ºä¸€å­£ï¼ˆä»…å‰§é›†æœ‰æ•ˆï¼‰     | å…³é—­   | `--combine-seasons`                  |
| `--season-mapping` | å­£å·æ˜ å°„ï¼ˆæ ¼å¼ï¼šåŸå­£å·=æ–°å­£å·ï¼‰      | æ—      | `--season-mapping "1=2"`             |

---

## è·å– API å¯†é’¥

1. è®¿é—® [TMDBå®˜ç½‘](https://www.themoviedb.org/)
2. åˆ›å»ºè´¦æˆ·å¹¶ç™»å½•
3. è¿›å…¥ API è®¾ç½®é¡µé¢
4. ç”³è¯· API å¯†é’¥ï¼ˆv3 æˆ– v4ï¼‰

---


### 1. è‡ªåŠ¨æ£€æµ‹ç±»å‹å¯¼å‡º

```bash
python tmdb_export.py 123456789 your_api_key ./output
```

### 2. å¯¼å‡ºç”µå½±

```bash
python tmdb_export.py 123456789 your_api_key ./output --type movie
```

### 3. å¯¼å‡ºå‰§é›†ï¼ˆä¿æŒåŸå­£ç»“æ„ï¼‰

```bash
python tmdb_export.py 123456789 your_api_key ./output --type tv
```

### 4. å¯¼å‡ºå‰§é›†å¹¶åˆå¹¶æ‰€æœ‰å­£

```bash
python tmdb_export.py 3427 your_api_key ./output --type tv --combine-seasons
```

### 5. å¯¼å‡ºå‰§é›†å¹¶é‡æ–°æ˜ å°„å­£å·

```bash
# å°†ç¬¬1å­£å¯¼å‡ºä¸ºç¬¬2å­£
python tmdb_export.py 4013 your_api_key ./output --type tv --season-mapping "1=2"

# å¤šå­£æ˜ å°„ï¼šç¬¬1å­£â†’ç¬¬2å­£ï¼Œç¬¬2å­£â†’ç¬¬3å­£
python tmdb_export.py 12345 your_api_key ./output --type tv --season-mapping "1=2,2=3"
```

### 6. åˆå¹¶æ‰€æœ‰å­£å¹¶é‡æ–°æ˜ å°„å­£å·

```bash
# å°†æ‰€æœ‰å­£åˆå¹¶ä¸ºç¬¬2å­£
python tmdb_export.py 3427 your_api_key ./output --type tv --combine-seasons --season-mapping "1=2"
```

### 7. å¯¼å‡ºåˆé›†

```bash
python tmdb_export.py 123456789 your_api_key ./output --type collection
```

---

## è¾“å‡ºæ–‡ä»¶ç»“æ„

### ç”µå½±ç±»å‹

```
{output}/
  {tmdbid}/
    movie/
      all.json             # ç”µå½±å…ƒæ•°æ®
```

### å‰§é›†ç±»å‹

```
{output}/
  {tmdbid}/
    series/
      series.json              # å‰§é›†å…ƒæ•°æ®
      season-1.json            # å­£å…ƒæ•°æ®
      season-1-episode-1.json  # é›†å…ƒæ•°æ®
      ...
```

### åˆé›†ç±»å‹

```
{output}/
  {tmdbid}/
    collection/
      all.json             # åˆé›†å…ƒæ•°æ®
```

---

## é«˜çº§åŠŸèƒ½è¯´æ˜

### å­£åˆå¹¶ï¼ˆ`--combine-seasons`ï¼‰

- å°†æ‰€æœ‰å­£åˆå¹¶ä¸ºä¸€å­£ï¼ˆå‘½åä¸ºâ€œå…¨é›†â€ï¼‰
- é›†æ–‡ä»¶æŒ‰é¡ºåºé‡æ–°ç¼–å·

ä¾‹å¦‚ï¼šä¸‰å­£å‰§é›†åˆå¹¶åï¼Œé›†æ–‡ä»¶å¦‚ä¸‹ï¼š

```
season-1-episode-1.json ï¼ˆåŸS1E1ï¼‰
season-1-episode-2.json ï¼ˆåŸS1E2ï¼‰
...
season-1-episode-N.json ï¼ˆåŸS3æœ€åä¸€é›†ï¼‰
```

---

### å­£å·æ˜ å°„ï¼ˆ`--season-mapping`ï¼‰

- æ ¼å¼ï¼šåŸå­£å·=æ–°å­£å·
- æ”¯æŒå¤šå­£æ˜ å°„ï¼š`1=2,2=3`
- åŒæ—¶æ”¹å˜æ–‡ä»¶åå’Œå…ƒæ•°æ®ä¸­çš„å­£å·å¼•ç”¨

ç¤ºä¾‹ï¼š

```bash
--season-mapping "1=2"
```

- å­£æ–‡ä»¶ï¼š`season-2.json`
- é›†æ–‡ä»¶ï¼š`season-2-episode-1.json` ç­‰

---

### ç»„åˆä½¿ç”¨

å¯ä»¥åŒæ—¶ä½¿ç”¨å­£åˆå¹¶ä¸å­£å·æ˜ å°„ï¼š

```bash
python tmdb_export.py 3427 your_api_key ./output --type tv --combine-seasons --season-mapping "1=2"
```

---

## æ³¨æ„äº‹é¡¹

### APIè°ƒç”¨é™åˆ¶

- TMDB API æœ‰é€Ÿç‡é™åˆ¶ï¼ˆçº¦ 40 è¯·æ±‚ / 10 ç§’ï¼‰
- å¤§å‹å‰§é›†å¯¼å‡ºå¯èƒ½è€—æ—¶è¾ƒé•¿
- å·²å†…ç½®æŒ‡æ•°é€€é¿æœºåˆ¶ï¼ˆé—´éš”ï¼š1s, 2s, 4s...ï¼Œæœ€å¤š5æ¬¡é‡è¯•ï¼‰

### æ•°æ®å®Œæ•´æ€§

- å•é›†å¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªå¯¼å‡ºè¿‡ç¨‹
- ä¼šè¾“å‡ºè¯¦ç»†é”™è¯¯æ—¥å¿—

### ç‰¹æ®Šå­£å¤„ç†

- ç¬¬0å­£ï¼ˆç‰¹è¾‘å­£ï¼‰é»˜è®¤è·³è¿‡
- ä»…å¤„ç†å­£å·å¤§äº0çš„æ­£å­£

### è¯­è¨€æ”¯æŒ

- ä¼˜å…ˆè¿”å›ç®€ä½“ä¸­æ–‡
- ä¸­æ–‡ç¼ºå¤±æ—¶è‡ªåŠ¨å›é€€è‹±æ–‡
- éƒ¨åˆ†å­—æ®µå¯èƒ½æ— ç¿»è¯‘

### æ–‡ä»¶è¦†ç›–

- æ¯æ¬¡è¿è¡Œä¼šè¦†ç›–å·²æœ‰åŒåæ–‡ä»¶
- å»ºè®®ä½¿ç”¨æ–°çš„è¾“å‡ºç›®å½•ä»¥é¿å…å†²çª

---

## è¾“å‡º JSON æ¨¡æ¿ç¤ºä¾‹

### ğŸ¬ ç”µå½± `all.json`
```json
{
  "id": 123456789,
  "imdb_id": "",
  "title": "test movie",
  "original_title": "",
  "overview": "test movie overview",
  "tagline": "",
  "release_date": "",
  "vote_average": 0.0,
  "production_countries": [],
  "production_companies": [],
  "genres": [],
  "casts": {
    "cast": [],
    "crew": []
  },
  "releases": {
    "countries": []
  },
  "belongs_to_collection": null,
  "trailers": {
    "youtube": []
  }
}
```

### ğŸ“º èŠ‚ç›® `series.json`
```json
{
  "id": 123456789,
  "name": "test series",
  "original_name": "",
  "overview": "test series overview",
  "vote_average": 0.0,
  "episode_run_time": [],
  "first_air_date": "1970-01-01T00:00:00.000Z",
  "last_air_date": "1970-01-01T00:00:00.000Z",
  "status": "",
  "networks": [],
  "genres": [],
  "external_ids": {
    "imdb_id": "",
    "tvrage_id": null,
    "tvdb_id": null
  },
  "videos": {
    "results": []
  },
  "content_ratings": {
    "results": []
  },
  "credits": {
    "cast": []
  }
}
```

### ğŸ“¦ å­£ `season-1.json`
```json
{
  "name": "test season 1",
  "overview": "test season 1 overview",
  "air_date": "1970-01-01T00:00:00.000Z",
  "external_ids": {
    "tvdb_id": null
  },
  "credits": {
    "cast": [],
    "crew": []
  }
}
```

### ğŸï¸ é›† `season-1-episode-1.json`
```json
{
  "name": "test episode 1",
  "overview": "test episode 1 overview",
  "videos": {
    "results": []
  },
  "external_ids": {
    "tvdb_id": null,
    "tvrage_id": null,
    "imdb_id": ""
  },
  "air_date": "1970-01-01T00:00:00.000Z",
  "vote_average": 0.0,
  "credits": {
    "cast": [],
    "guest_stars": [],
    "crew": []
  }
}
```

### ğŸ“š åˆé›† `all.json`
```json
{
  "id": 123456789,
  "name": "test collection",
  "overview": ""
}
```
# ğŸ“ è„šæœ¬äºŒï¼šcompare_media.py

ä¸€ä¸ªç”¨äºæ”¯æŒæ¯”å¯¹ä¸¤ä¸ªç›®å½•ä¸­çš„è§†é¢‘æ–‡ä»¶å·®å¼‚çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

## ğŸ§° åŠŸèƒ½ä»‹ç»

- æ”¯æŒä¸¤ç§æ¯”è¾ƒæ¨¡å¼ï¼š
  - ğŸ“º **å‰§é›†æ¨¡å¼**ï¼ˆæ”¯æŒè¯†åˆ« SxxExx æ ¼å¼çš„é›†æ•°ä¿¡æ¯ï¼‰
  - ğŸ¬ **ç”µå½±æ¨¡å¼**ï¼ˆæ ¹æ®ç›®å½•ç»“æ„è¿›è¡Œæ¯”å¯¹ï¼‰
- è‡ªåŠ¨æå–è§†é¢‘æ–‡ä»¶çš„åˆ†è¾¨ç‡ï¼ˆå¦‚ 1080pã€2160pï¼‰
- æ”¯æŒä»¥ä¸‹è§†é¢‘æ ¼å¼ï¼š`.mkv`ã€`.mp4`ã€`.avi`ã€`.mov`ã€`.flv`ã€`.wmv`
- ç”Ÿæˆå¯¹æ¯”å·®å¼‚æŠ¥å‘Šï¼ˆåŒ…æ‹¬ç¼ºå¤±ã€å¤§å°ä¸åŒã€åˆ†è¾¨ç‡å·®å¼‚ç­‰ï¼‰
- å‹å¥½çš„ç»ˆç«¯è¿›åº¦æŒ‡ç¤ºï¼ˆå¸¦æ—‹è½¬å›¾æ ‡ï¼‰
- è¾“å‡ºæ—¥å¿—ä¿å­˜ä¸º `.log` æ–‡ä»¶ï¼Œå¯é€‰ç›®å½•

## ğŸ“‚ ä½¿ç”¨ç¤ºä¾‹

1. è¿è¡Œè„šæœ¬ï¼š

```bash
python media_compare.py
```

2. é€‰æ‹©æ¨¡å¼ï¼š

```
è¯·è¾“å…¥é€‰æ‹© (1/2):
  1. å‰§é›†æ¨¡å¼ (TV Shows)
  2. ç”µå½±æ¨¡å¼ (Movies)
```

3. è¾“å…¥æ¯”è¾ƒè·¯å¾„ï¼š

```
æ•´ç†åŒ…è·¯å¾„: /path/to/source_folder
åª’ä½“åº“åŒ…è·¯å¾„: /path/to/library_folder
æ—¥å¿—è¾“å‡ºç›®å½• (ç•™ç©ºä¸ºå½“å‰ç›®å½•): /path/to/output
```

4. è„šæœ¬å°†è‡ªåŠ¨æ‰«ææ–‡ä»¶ç»“æ„ï¼Œæå–åˆ†è¾¨ç‡ä¸å¤§å°ï¼Œç”Ÿæˆ `.log` æ—¥å¿—æŠ¥å‘Šã€‚

---

## ğŸ“‹ è¾“å‡ºç¤ºä¾‹

ç”µå½±æ¨¡å¼ä¸‹ï¼š

```
[ç”µå½±] MovieAï¼ˆæ•´ç†åŒ…æœ‰ï¼Œåª’ä½“åº“åŒ…æ— ï¼‰
  æ•´ç†åŒ…æ–‡ä»¶åˆ—è¡¨:
    â”œâ”€ MovieA.1080p.mp4 (1080P, 2.36GB)
```

å‰§é›†æ¨¡å¼ä¸‹ï¼š

```
[ç›®å½•] Season 1ï¼ˆæ•´ç†åŒ…æœ‰ï¼Œåª’ä½“åº“åŒ…æœ‰ï¼‰
  â”œâ”€ [é›†] S01E01ï¼ˆå¤§å°ä¸åŒï¼‰
  â”‚   â”œâ”€ æ•´ç†åŒ…: E01.1080p.mkv (2.1GB)
  â”‚   â””â”€ åª’ä½“åº“åŒ…: E01.1080p.mkv (1.9GB)
```

---

## ğŸ›  æ”¯æŒçš„æ ¼å¼

- è§†é¢‘æ‰©å±•åï¼š`.mp4`, `.mkv`, `.avi`, `.mov`, `.flv`, `.wmv`
- åˆ†è¾¨ç‡è¯†åˆ«ï¼šæ”¯æŒå¦‚ `720p`, `1080p`, `2160p` ç­‰
- å‰§é›†è¯†åˆ«æ ¼å¼ï¼šå¦‚ `S01E02`, `s02e03` ç­‰

---

## ğŸ§© ä¾èµ–ç¯å¢ƒ

æ ‡å‡† Python 3 ç¯å¢ƒï¼Œæ— é¢å¤–ç¬¬ä¸‰æ–¹ä¾èµ–ã€‚

---

## ğŸ“„ æ—¥å¿—æ–‡ä»¶å‘½åè§„åˆ™

æ—¥å¿—æ–‡ä»¶é»˜è®¤å‘½åä¸ºï¼š

```
YYYYMMDD_HHMMSS_ç”µå½±æ¯”è¾ƒæŠ¥å‘Š.log
æˆ–
YYYYMMDD_HHMMSS_å‰§é›†æ¯”è¾ƒæŠ¥å‘Š.log
```

---
